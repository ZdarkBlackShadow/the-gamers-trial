{{define "question"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Gamer's Trial</title>
    <link rel="stylesheet" href="/static/css/main.css" />
    <link rel="stylesheet" href="/static/css/questions.css" />
    <script src="/static/js/questions.js"></script>
</head>
<body>
    {{if .HasError}}
    <div class="error-container">
        <p class="error-type">{{.ErrorDetail.ErrorType}}</p>
        <p class="error-text">{{.ErrorDetail.ErrorText}}</p>
    </div>
    {{end}}
    
    {{if .State}}
    {{/* User must answer the question */}}
    {{if .HasImage}}
    <div class="question-image-container">
        <img src="/image/{{.ImagePath}}" alt="Question Image" class="question-content-image" />
    </div>
    {{end}}
    
    <div class="question-header">
        <p class="question-text">{{.Content}}</p>
    </div>
    
    <form id="question-form">
        <input type="hidden" id="question_id" value="{{.ID}}" />
        <div class="answers-container">
            {{range .Options}}
            <div class="answer-option" data-option-id="{{.ID}}">
                <input type="radio" name="user_answer_id" value="{{.ID}}" id="option-{{.ID}}" />
                <label for="option-{{.ID}}">{{.Text}}</label>
            </div>
            {{end}}
        </div>
        <button type="submit" class="submit-answer-btn">Submit Answer</button>
    </form>
    {{else}}
    {{/* User has already answered - show result */}}
    {{if .HasImage}}
    <div class="question-image-container">
        <img src="/image/{{.ImagePath}}" alt="Question Image" class="question-content-image" />
    </div>
    {{end}}
    
    <div class="question-header">
        <p class="question-text">{{.Content}}</p>
    </div>
    
    <div class="result-container">
        {{if .UserHasCorrect}}
        <p class="result-message correct">Correct! Well done!</p>
        {{else}}
        <p class="result-message incorrect">Incorrect. Better luck next time!</p>
        {{end}}
        
        <div class="score-info">
            <p>Previous Score: {{.OldUserScore}}</p>
            <p>New Score: {{.NewUserScore}}</p>
        </div>
        
        <p class="redirect-message">Redirecting to next question in <span id="countdown">30</span> seconds...</p>
    </div>
    {{end}}
</body>
</html>
{{end}}